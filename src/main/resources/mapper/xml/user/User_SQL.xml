<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.talmo.vim.login.UserMapper">

	<insert id="insertTalmoMember" parameterType="HashMap">
	<![CDATA[
		INSERT INTO TMV_USER
		(
			EMAIL, PASSWORD, USER_ROLE, NAME, NICK,
			GENDER, TEL1, TEL2, TEL3, ZIPCODE,
			ADDR1, ADDR2, LEVEL, POINT, DI,
			INSERT_DT, UPDATE_DT, STATUS, LAST_LOGIN_DT, SESSION_ID,
			SESSION_EXPIRE_DT
		)
		VALUES
		(
			#{email}, #{password}, 'ROLE_USER', #{name}, #{nick},
			'1', #{tel1}, #{tel2}, #{tel3}, null,
			null, null, 0, 0, null,
			now(), null, 'USE', null, null,
			null
		)
	]]>
	</insert>
	
	<insert id="insertSNSMember" parameterType="HashMap">
		<![CDATA[
			INSERT INTO TMV_SNS_USER
			(
				SNS_ID, SNS_TYPE, SNS_EMAIL, SNS_INSERT_DT, SNS_TOKEN
			)
			VALUES
			(
				#{snsId}, #{snsType}, #{snsEmail}, now(), null
			)
		]]>
	</insert>

	<select id="getTalmoInfo" parameterType="HashMap" resultType="com.talmo.vim.login.UserVO">
		<![CDATA[
			SELECT 
				CODE, EMAIL, USER_ROLE, NAME, NICK,
				GENDER, TEL1, TEL2, TEL3, ZIPCODE,
				ADDR1, ADDR2, LEVEL, POINT, INSERT_DT,
				UPDATE_DT, STATUS, LAST_LOGIN_DT, SESSION_ID, SESSION_EXPIRE_DT
			FROM 
				TMV_USER
			WHERE
				EMAIL = #{email}
				AND PASSWORD = #{password}
		]]>
	</select>
	
	<select id="getTalmoInfoByCode" parameterType="hashMap" resultType="com.talmo.vim.login.UserVO">
		<![CDATA[
			SELECT
				CODE, EMAIL, USER_ROLE, NAME, NICK,
				GENDER, TEL1, TEL2, TEL3, ZIPCODE,
				ADDR1, ADDR2, LEVEL, POINT, INSERT_DT,
				UPDATE_DT, STATUS, LAST_LOGIN_DT, SESSION_ID, SESSION_EXPIRE_DT
			FROM
				TMV_USER
			WHERE
				CODE = #{TMV_CODE}
		]]>
	</select>
	
	<select id="getSNSInfo" parameterType="HashMap" resultType="hashMap">
		SELECT 
			SNS_CODE, SNS_ID, SNS_TYPE, SNS_EMAIL, SNS_INSERT_DT, TMV_CODE
		FROM 
			TMV_SNS_USER
		WHERE
			SNS_ID = #{snsId}
			AND SNS_TYPE = #{snsType}
	</select>
</mapper>