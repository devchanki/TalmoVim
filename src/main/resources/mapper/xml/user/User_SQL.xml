<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.talmo.vim.login.UserMapper">

	<insert id="insertTalmoMember" parameterType="HashMap">
	<![CDATA[
		INSERT INTO TMV_USER
		(
			USER_EMAIL, USER_PASSWORD, USER_ROLE, USER_NAME, USER_NICK,
			USER_GENDER, USER_TEL1, USER_TEL2, USER_TEL3, USER_ZIPCODE,
			USER_ADDR1, USER_ADDR2, USER_LEVEL, USER_POINT, USER_DI,
			USER_INSERT_DT, USER_UPDATE_DT, USER_STATUS, USER_LAST_LOGIN_DT, USER_SESSION_ID,
			USER_SESSION_EXPIRE_DT
		)
		VALUES
		(
			#{email}, #{password}, 'ROLE_USER', #{name}, #{nick},
			'1', #{tel1}, #{tel2}, #{tel3}, null,
			null, null, 0, 0, null,
			now(), null, 'USE', null, null,
			null
		)
	]]>
	</insert>
	
	<insert id="insertSNSMember" parameterType="HashMap">
		<![CDATA[
			INSERT INTO TMV_SNS_USER
			(
				SNS_KEY, SNS_TYPE, SNS_EMAIL, SNS_INSERT_DT, SNS_TOKEN, USER_ID
			)
			VALUES
			(
				#{snsId}, #{snsType}, #{snsEmail}, now(), null, #{userId}
			)
		]]>
	</insert>

	<select id="getTalmoInfo" parameterType="HashMap" resultType="com.talmo.vim.login.UserVO">
		<![CDATA[
			SELECT 
				USER_ID, USER_EMAIL, USER_ROLE, USER_NAME, USER_NICK,
				USER_GENDER, USER_TEL1, USER_TEL2, USER_TEL3, USER_ZIPCODE,
				USER_ADDR1, USER_ADDR2, USER_LEVEL, USER_POINT, USER_INSERT_DT,
				USER_UPDATE_DT, USER_STATUS, USER_LAST_LOGIN_DT, USER_SESSION_ID, USER_SESSION_EXPIRE_DT
			FROM 
				TMV_USER
			WHERE
				USER_EMAIL = #{email}
				AND USER_PASSWORD = #{password}
		]]>
	</select>
	
	<select id="getTalmoInfoByCode" parameterType="hashMap" resultType="com.talmo.vim.login.UserVO">
		<![CDATA[
			SELECT
				USER_ID, USER_EMAIL, USER_ROLE, USER_NAME, USER_NICK,
				USER_GENDER, USER_TEL1, USER_TEL2, USER_TEL3, USER_ZIPCODE,
				USER_ADDR1, USER_ADDR2, USER_LEVEL, USER_POINT, USER_INSERT_DT,
				UPDATE_DT, USER_STATUS, USER_LAST_LOGIN_DT, USER_SESSION_ID, USER_SESSION_EXPIRE_DT
			FROM
				TMV_USER
			WHERE
				USER_ID = #{USER_ID}
		]]>
	</select>
	
	<select id="getSNSInfo" parameterType="HashMap" resultType="hashMap">
		SELECT 
			SNS_KEY, SNS_TYPE, SNS_EMAIL, SNS_INSERT_DT, USER_ID
		FROM 
			TMV_SNS_USER
		WHERE
			SNS_KEY = #{snsId}
			AND SNS_TYPE = #{snsType}
	</select>
</mapper>